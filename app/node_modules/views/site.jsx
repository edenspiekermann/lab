"use strict";
var React            = require('react');
var { RouteHandler } = require('react-router');

var ContextMixin = require('mixins/context');

var App = React.createClass({

  mixins: [ContextMixin],

  render() {
    return (
      <html lang="en">
      <head>
        <meta httpEquiv="X-UA-Compatible" content="IE=edge" />
        <title>Amaphiko</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="/assets/index.css" rel="stylesheet" />
      </head>
      <body>
        <RouteHandler {...this.props} />
      </body>
      <script dangerouslySetInnerHTML={{ __html: "window.amaphiko={};" }} />
      <script src={'/assets/locales/'+this.props.session.locale+'.js'} />
      <script dangerouslySetInnerHTML={{
        __html: "(function(d) {"
          +"window.amaphiko.session = \""+encodeURIComponent(JSON.stringify(this.props.session))+"\";"
          +"window.amaphiko.asyncData = \""+encodeURIComponent(JSON.stringify(this.props.asyncData))+"\";"
          +"var s = d.createElement('script');"
          +"s.src = '/assets/bundle.js';"
          +"d.head.appendChild(s);"
          +"})(document);"
      }} />
      </html>
    );
  }

});

module.exports = App;
